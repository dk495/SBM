function pingAPI(){document.getElementById("submitBtn").disabled=!0;const e=new FormData;e.append("trackdrive_number","+18336032792"),e.append("traffic_source_id","1005"),e.append("caller_id","+1"+document.getElementById("caller_id").value),e.append("first_name",document.getElementById("first_name").value),e.append("last_name",document.getElementById("last_name").value),e.append("zip",document.getElementById("zip").value),e.append("city",document.getElementById("city").value),e.append("state",document.getElementById("state").value);const t="https://pegasus-leads.trackdrive.com/api/v1/inbound_webhooks/ping/check_for_available_aca_transfers_data_posting?"+new URLSearchParams(e).toString(),n="https://corsproxy.io/?"+t;fetch(n).then(e=>e.json()).then(e=>{e.success?(postPingId(e.try_all_buyers.ping_id)): (document.getElementById("apiResponse").innerHTML="Ping ok but. Error: "+e.errors.join(", "),document.getElementById("apiResponse").classList.add("alert-danger"),document.getElementById("apiResponse").classList.remove("alert-info"))}).catch(e=>{document.getElementById("apiResponse").innerHTML="Error fetching data from the API.",document.getElementById("apiResponse").classList.add("alert-danger"),document.getElementById("apiResponse").classList.remove("alert-info")})}function postPingId(e){const t={trackdrive_number:"+18336032792",traffic_source_id:"1005",first_name:document.getElementById("first_name").value,last_name:document.getElementById("last_name").value,caller_id:"+1"+document.getElementById("caller_id").value,ping_id:e,zip:document.getElementById("zip").value,city:document.getElementById("city").value,state:document.getElementById("state").value},n="https://pegasus-leads.trackdrive.com/api/v1/inbound_webhooks/post/check_for_available_aca_transfers_data_posting",o="https://corsproxy.io/?"+encodeURIComponent(n);fetch(o,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}).then(e=>{200===e.status||201===e.status?(e.text().then(e=>{const t=`<div class="alert alert-success" role="alert">Form submitted successfully! Response Body: ${e}</div>`;document.getElementById("alertContainer").innerHTML="",document.getElementById("alertContainer").insertAdjacentHTML("beforeend",t)})):422===e.status?(e.json().then(e=>{const t=`<div class="alert alert-danger" role="alert">Error. Response Body: ${JSON.stringify(e)}</div>`;document.getElementById("alertContainer").innerHTML="",document.getElementById("alertContainer").insertAdjacentHTML("beforeend",t)})):(e.text().then(e=>{const t=`<div class="alert alert-danger" role="alert">Form submission failed. Please try again. Response Body: ${e}</div>`;document.getElementById("alertContainer").innerHTML="",document.getElementById("alertContainer").insertAdjacentHTML("beforeend",t)}))}).catch(e=>console.error("Error:",e));}document.getElementById("leadForm").addEventListener("submit",function(e){e.preventDefault(),pingAPI()});
